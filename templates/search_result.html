{% extends "base.html" %}

{% block content %}

<div class="container-fluid py-5">
    <div class="container pt-5 pb-3">

<!-- Booking Start -->
<div class="container-fluid booking mt-5 pb-5">
    <div class="container pb-5">
        <div class="search-container shadow">
            <div class="row align-items-center" style="min-height: 60px;">
                <!-- On large screens (lg and above), the input takes 9 columns and the button takes 3 columns -->
                <!-- On smaller screens (sm and below), both take 12 columns, stacking on top of each other -->
                <div class="col-lg-12 col-md-12 mb-3 mb-lg-0">
                    <form action="{{ url_for('search_business') }}" method="get">
                        <input type="text" name="search_query"
                            placeholder="Search by category, business name, or shop number" required>
                        <button class="btn btn-primary btn-block" type="submit">Search</button>
                    </form>
                </div>

            </div>
        </div>
    </div>
</div>
        <!-- -->

        <div class="text-center mb-3 pb-3">
            <h6 class="text-primary text-uppercase" style="letter-spacing: 5px;">Search Results</h6>

            {% if search_query %}
            <h1>Search results for <span style="color: #7AB730;">"{{ search_query }}"</span> </h1>
            {% else %}
            <h1>No search query provided</h1>
            {% endif %}
        </div>

        <div class="row justify-content-center">
            {% if businesses %}
            {% for business in businesses %}
            <div
                class="{% if businesses|length == 1 %}col-lg-6 col-md-8 col-sm-10 col-12{% elif businesses|length == 2 %}col-lg-6 col-md-6 col-sm-8 col-12{% else %}col-lg-3 col-md-4 col-sm-6 col-12{% endif %} mb-4">
                <div class="package-item bg-white mb-2 h-100">
                    {% if business.media_type and business.media_url %}
                    {% if business.media_type == 'image' %}
                    <div class="image-container" style="height: 200px; overflow: hidden;">
                        <h6 class="m-0">
                            <i class="fa fa-star text-primary mr-2"
                                style="position: absolute; text-shadow: 2px 2px 4px rgba(216, 216, 216, 0.5);">
                                <span>premier</span>
                            </i>
                        </h6>
                        <img src="../{{ business.media_url }}" alt="Business Image" class="img-fluid"
                            style=" width: 100%; height: 100%;">
                    </div>
                    {% elif business.media_type == 'video' %}
                    <div class="image-container" style="height: 200px; overflow: hidden;">
                        <h6 class="m-0">
                            <i class="fa fa-star text-primary mr-2"
                                style="position: absolute; text-shadow: 2px 2px 4px rgba(216, 216, 216, 0.5);">
                                <span>premier</span>
                            </i>
                        </h6>
                        <video width="100%" height="100%" controls
                            style=" width: 100%; height: 100%;">
                            <source src="../{{ business.media_url }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    {% endif %}
                    {% else %}
                    <div class="image-container" style="height: 200px; overflow: hidden;">
                        <h6 class="m-0">
                            <i class="fa fa-star text-primary mr-2" style="position: absolute;">
                                <span>premier</span>
                            </i>
                        </h6>
                        <a href="{{ url_for('register_user') }}">
                            <img src="./static/img/dunis_placeholder.png" alt="Business Image"
                                class="img-fluid rounded" style=" width: 100%; height: 100%;">
                        </a>
                    </div>
                    {% endif %}
                    <div class="p-4">
                        <div class="d-flex justify-content-between mb-3">
                            <small class="m-0"><i class="fa fa-phone-alt text-primary mr-2"></i>{{ business.phone_number }}</small>
                            <small class="m-0"><i class="fa fa-store text-primary mr-2"></i>{{ business.category_name }}</small>
                        </div>
                        <a class="h5 text-decoration-none"
                            style="display: flex !important; justify-content: center !important; font-weight: bold;"
                            href="#">{{ business.business_name }}</a>
                        <div class="border-top mt-4 pt-4">
                            <div class=""
                                style="display: flex !important; justify-content: center !important; align-items: center !important;">
                                <h6 class="m-0"> <span class="text-primary">Your-site.com here</span></span>
                                </h6>
                            </div>
                            <!---->
                                                         <!-- Claim Button -->
                        {% if session.get('user_logged_in') %}
                        <div class="text-center mt-3">
                            <a href="{{ url_for('claim_business', business_id=business.id ) }}"
                                class="btn btn-primary">Claim Business</a>
                        </div>
                        {% else %}
                        <div class="text-center mt-3">
                            <a href="{{ url_for('register_user') }}" class="btn btn-danger rounded">Register Business</a>
                        </div>
                        {% endif %}
                            <!---->
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="col-12">
                <div class="alert alert-info text-center" role="alert"
                    style="background-color: #040450; padding: 10px; color: #fff;">
                    No businesses found for your search.
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}
